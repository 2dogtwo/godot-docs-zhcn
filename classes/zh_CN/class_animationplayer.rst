:github_url: hide

.. DO NOT EDIT THIS FILE!!!
.. Generated automatically from Godot engine sources.
.. Generator: https://github.com/godotengine/godot/tree/master/doc/tools/make_rst.py.
.. XML source: https://github.com/godotengine/godot/tree/master/doc/classes/AnimationPlayer.xml.

.. _class_AnimationPlayer:

AnimationPlayer
===============

**Inherits:** :ref:`Node<class_Node>` **<** :ref:`Object<class_Object>`

用于播放动画的节点。

.. rst-class:: classref-introduction-group

Description
-----------

动画播放器用于动画的通用播放。它包含 :ref:`AnimationLibrary<class_AnimationLibrary>` 资源的字典和动画过渡之间的自定义混合时间。

某些方法和属性使用单个键直接引用动画。这些键的格式为动画库的键，后跟正斜杠，然后是动画库内动画的键，例如 ``"movement/run"``\ 。如果动画库的键为空字符串（称为默认库），则省略正斜杠，与动画库使用相同的键。

\ **AnimationPlayer** 比 :ref:`Tween<class_Tween>` 更适合用于复杂动画，例如不规则计时的动画。如果用动画轨道编辑器比用代码实现更方便，也可以优先于 :ref:`Tween<class_Tween>` 使用。

更新动画的目标属性是在处理帧中进行的。

.. rst-class:: classref-introduction-group

Tutorials
---------

- :doc:`2D 精灵动画 <../tutorials/2d/2d_sprite_animation>`

- :doc:`动画教程索引 <../tutorials/animation/index>`

- `第三人称射击演示 <https://godotengine.org/asset-library/asset/678>`__

.. rst-class:: classref-reftable-group

Properties
----------

.. table::
   :widths: auto

   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`String<class_String>`                                                    | :ref:`assigned_animation<class_AnimationPlayer_property_assigned_animation>`                   |                    |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`int<class_int>`                                                          | :ref:`audio_max_polyphony<class_AnimationPlayer_property_audio_max_polyphony>`                 | ``32``             |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`String<class_String>`                                                    | :ref:`autoplay<class_AnimationPlayer_property_autoplay>`                                       | ``""``             |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`String<class_String>`                                                    | :ref:`current_animation<class_AnimationPlayer_property_current_animation>`                     | ``""``             |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`float<class_float>`                                                      | :ref:`current_animation_length<class_AnimationPlayer_property_current_animation_length>`       |                    |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`float<class_float>`                                                      | :ref:`current_animation_position<class_AnimationPlayer_property_current_animation_position>`   |                    |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>`   | :ref:`method_call_mode<class_AnimationPlayer_property_method_call_mode>`                       | ``0``              |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`bool<class_bool>`                                                        | :ref:`movie_quit_on_finish<class_AnimationPlayer_property_movie_quit_on_finish>`               | ``false``          |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`bool<class_bool>`                                                        | :ref:`playback_active<class_AnimationPlayer_property_playback_active>`                         |                    |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`float<class_float>`                                                      | :ref:`playback_default_blend_time<class_AnimationPlayer_property_playback_default_blend_time>` | ``0.0``            |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` | :ref:`playback_process_mode<class_AnimationPlayer_property_playback_process_mode>`             | ``1``              |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`bool<class_bool>`                                                        | :ref:`reset_on_save<class_AnimationPlayer_property_reset_on_save>`                             | ``true``           |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`NodePath<class_NodePath>`                                                | :ref:`root_node<class_AnimationPlayer_property_root_node>`                                     | ``NodePath("..")`` |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+
   | :ref:`float<class_float>`                                                      | :ref:`speed_scale<class_AnimationPlayer_property_speed_scale>`                                 | ``1.0``            |
   +--------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------+--------------------+

.. rst-class:: classref-reftable-group

Methods
-------

.. table::
   :widths: auto

   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Variant<class_Variant>`                     | :ref:`_post_process_key_value<class_AnimationPlayer_method__post_process_key_value>` **(** :ref:`Animation<class_Animation>` animation, :ref:`int<class_int>` track, :ref:`Variant<class_Variant>` value, :ref:`Object<class_Object>` object, :ref:`int<class_int>` object_idx **)** |virtual| |const| |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Error<enum_@GlobalScope_Error>`             | :ref:`add_animation_library<class_AnimationPlayer_method_add_animation_library>` **(** :ref:`StringName<class_StringName>` name, :ref:`AnimationLibrary<class_AnimationLibrary>` library **)**                                                                                                         |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`advance<class_AnimationPlayer_method_advance>` **(** :ref:`float<class_float>` delta **)**                                                                                                                                                                                                       |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`StringName<class_StringName>`               | :ref:`animation_get_next<class_AnimationPlayer_method_animation_get_next>` **(** :ref:`StringName<class_StringName>` anim_from **)** |const|                                                                                                                                                           |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`animation_set_next<class_AnimationPlayer_method_animation_set_next>` **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to **)**                                                                                                                      |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`clear_caches<class_AnimationPlayer_method_clear_caches>` **(** **)**                                                                                                                                                                                                                             |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`clear_queue<class_AnimationPlayer_method_clear_queue>` **(** **)**                                                                                                                                                                                                                               |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`StringName<class_StringName>`               | :ref:`find_animation<class_AnimationPlayer_method_find_animation>` **(** :ref:`Animation<class_Animation>` animation **)** |const|                                                                                                                                                                     |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`StringName<class_StringName>`               | :ref:`find_animation_library<class_AnimationPlayer_method_find_animation_library>` **(** :ref:`Animation<class_Animation>` animation **)** |const|                                                                                                                                                     |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`Animation<class_Animation>`                 | :ref:`get_animation<class_AnimationPlayer_method_get_animation>` **(** :ref:`StringName<class_StringName>` name **)** |const|                                                                                                                                                                          |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`AnimationLibrary<class_AnimationLibrary>`   | :ref:`get_animation_library<class_AnimationPlayer_method_get_animation_library>` **(** :ref:`StringName<class_StringName>` name **)** |const|                                                                                                                                                          |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`StringName[]<class_StringName>`             | :ref:`get_animation_library_list<class_AnimationPlayer_method_get_animation_library_list>` **(** **)** |const|                                                                                                                                                                                         |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`PackedStringArray<class_PackedStringArray>` | :ref:`get_animation_list<class_AnimationPlayer_method_get_animation_list>` **(** **)** |const|                                                                                                                                                                                                         |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`float<class_float>`                         | :ref:`get_blend_time<class_AnimationPlayer_method_get_blend_time>` **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to **)** |const|                                                                                                                      |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`float<class_float>`                         | :ref:`get_playing_speed<class_AnimationPlayer_method_get_playing_speed>` **(** **)** |const|                                                                                                                                                                                                           |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`PackedStringArray<class_PackedStringArray>` | :ref:`get_queue<class_AnimationPlayer_method_get_queue>` **(** **)**                                                                                                                                                                                                                                   |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                           | :ref:`has_animation<class_AnimationPlayer_method_has_animation>` **(** :ref:`StringName<class_StringName>` name **)** |const|                                                                                                                                                                          |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                           | :ref:`has_animation_library<class_AnimationPlayer_method_has_animation_library>` **(** :ref:`StringName<class_StringName>` name **)** |const|                                                                                                                                                          |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | :ref:`bool<class_bool>`                           | :ref:`is_playing<class_AnimationPlayer_method_is_playing>` **(** **)** |const|                                                                                                                                                                                                                         |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`pause<class_AnimationPlayer_method_pause>` **(** **)**                                                                                                                                                                                                                                           |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`play<class_AnimationPlayer_method_play>` **(** :ref:`StringName<class_StringName>` name="", :ref:`float<class_float>` custom_blend=-1, :ref:`float<class_float>` custom_speed=1.0, :ref:`bool<class_bool>` from_end=false **)**                                                                  |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`play_backwards<class_AnimationPlayer_method_play_backwards>` **(** :ref:`StringName<class_StringName>` name="", :ref:`float<class_float>` custom_blend=-1 **)**                                                                                                                                  |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`queue<class_AnimationPlayer_method_queue>` **(** :ref:`StringName<class_StringName>` name **)**                                                                                                                                                                                                  |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`remove_animation_library<class_AnimationPlayer_method_remove_animation_library>` **(** :ref:`StringName<class_StringName>` name **)**                                                                                                                                                            |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`rename_animation_library<class_AnimationPlayer_method_rename_animation_library>` **(** :ref:`StringName<class_StringName>` name, :ref:`StringName<class_StringName>` newname **)**                                                                                                               |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`seek<class_AnimationPlayer_method_seek>` **(** :ref:`float<class_float>` seconds, :ref:`bool<class_bool>` update=false **)**                                                                                                                                                                     |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`set_blend_time<class_AnimationPlayer_method_set_blend_time>` **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to, :ref:`float<class_float>` sec **)**                                                                                               |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | void                                              | :ref:`stop<class_AnimationPlayer_method_stop>` **(** :ref:`bool<class_bool>` keep_state=false **)**                                                                                                                                                                                                    |
   +---------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

Signals
-------

.. _class_AnimationPlayer_signal_animation_changed:

.. rst-class:: classref-signal

**animation_changed** **(** :ref:`StringName<class_StringName>` old_name, :ref:`StringName<class_StringName>` new_name **)**

在前一个动画完成后，播放队列中的动画时发出。请参阅 :ref:`queue<class_AnimationPlayer_method_queue>`\ 。

\ **注意：**\ 通过 :ref:`play<class_AnimationPlayer_method_play>` 或 :ref:`AnimationTree<class_AnimationTree>` 改变动画时，不会发出此信号。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_signal_animation_finished:

.. rst-class:: classref-signal

**animation_finished** **(** :ref:`StringName<class_StringName>` anim_name **)**

动画播放结束时通知。

\ **注意：**\ 如果动画正在循环播放，则不会发出此信号。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_signal_animation_libraries_updated:

.. rst-class:: classref-signal

**animation_libraries_updated** **(** **)**

当动画库发生更改时发出通知。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_signal_animation_list_changed:

.. rst-class:: classref-signal

**animation_list_changed** **(** **)**

当动画列表发生更改时发出通知。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_signal_animation_started:

.. rst-class:: classref-signal

**animation_started** **(** :ref:`StringName<class_StringName>` anim_name **)**

当动画开始播放时发出通知。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_signal_caches_cleared:

.. rst-class:: classref-signal

**caches_cleared** **(** **)**

当缓存被清除时通知，可以是自动清除，也可以是通过 :ref:`clear_caches<class_AnimationPlayer_method_clear_caches>` 手动清除。

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

Enumerations
------------

.. _enum_AnimationPlayer_AnimationProcessCallback:

.. rst-class:: classref-enumeration

enum **AnimationProcessCallback**:

.. _class_AnimationPlayer_constant_ANIMATION_PROCESS_PHYSICS:

.. rst-class:: classref-enumeration-constant

:ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` **ANIMATION_PROCESS_PHYSICS** = ``0``

在物理帧中处理动画（见 :ref:`Node.NOTIFICATION_INTERNAL_PHYSICS_PROCESS<class_Node_constant_NOTIFICATION_INTERNAL_PHYSICS_PROCESS>`\ ）。尤其适用于对物理体进行动画处理。

.. _class_AnimationPlayer_constant_ANIMATION_PROCESS_IDLE:

.. rst-class:: classref-enumeration-constant

:ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` **ANIMATION_PROCESS_IDLE** = ``1``

在处理帧中处理动画（见 :ref:`Node.NOTIFICATION_INTERNAL_PROCESS<class_Node_constant_NOTIFICATION_INTERNAL_PROCESS>`\ ）。

.. _class_AnimationPlayer_constant_ANIMATION_PROCESS_MANUAL:

.. rst-class:: classref-enumeration-constant

:ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` **ANIMATION_PROCESS_MANUAL** = ``2``

不处理动画。使用\ :ref:`advance<class_AnimationPlayer_method_advance>`\ 手动处理动画。

.. rst-class:: classref-item-separator

----

.. _enum_AnimationPlayer_AnimationMethodCallMode:

.. rst-class:: classref-enumeration

enum **AnimationMethodCallMode**:

.. _class_AnimationPlayer_constant_ANIMATION_METHOD_CALL_DEFERRED:

.. rst-class:: classref-enumeration-constant

:ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>` **ANIMATION_METHOD_CALL_DEFERRED** = ``0``

在动画过程中批量调用方法，然后在处理完事件后再进行调用。这样就避免了在播放过程中涉及删除节点或修改AnimationPlayer的错误。

.. _class_AnimationPlayer_constant_ANIMATION_METHOD_CALL_IMMEDIATE:

.. rst-class:: classref-enumeration-constant

:ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>` **ANIMATION_METHOD_CALL_IMMEDIATE** = ``1``

在动画中达到时立即进行方法调用。

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

Property Descriptions
---------------------

.. _class_AnimationPlayer_property_assigned_animation:

.. rst-class:: classref-property

:ref:`String<class_String>` **assigned_animation**

.. rst-class:: classref-property-setget

- void **set_assigned_animation** **(** :ref:`String<class_String>` value **)**
- :ref:`String<class_String>` **get_assigned_animation** **(** **)**

如果正在播放，则为当前动画的键，否则为上次播放的动画。设置后会改变动画，但除非已经播放，否则不会播放。另见 :ref:`current_animation<class_AnimationPlayer_property_current_animation>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_audio_max_polyphony:

.. rst-class:: classref-property

:ref:`int<class_int>` **audio_max_polyphony** = ``32``

.. rst-class:: classref-property-setget

- void **set_audio_max_polyphony** **(** :ref:`int<class_int>` value **)**
- :ref:`int<class_int>` **get_audio_max_polyphony** **(** **)**

每个指定的 AudioStreamPlayer 可能同时发出的声音的数量。

例如，如果该值为 ``32`` 并且动画有两个音轨，则分配的两个 :ref:`AudioStreamPlayer<class_AudioStreamPlayer>` 可以同时播放最多 ``32`` 个声音。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_autoplay:

.. rst-class:: classref-property

:ref:`String<class_String>` **autoplay** = ``""``

.. rst-class:: classref-property-setget

- void **set_autoplay** **(** :ref:`String<class_String>` value **)**
- :ref:`String<class_String>` **get_autoplay** **(** **)**

场景加载时要播放的动画名称。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_current_animation:

.. rst-class:: classref-property

:ref:`String<class_String>` **current_animation** = ``""``

.. rst-class:: classref-property-setget

- void **set_current_animation** **(** :ref:`String<class_String>` value **)**
- :ref:`String<class_String>` **get_current_animation** **(** **)**

当前播放的动画的名称。如果没有动画正在播放，该属性的值是一个空字符串。改变这个值不会重新启动动画。关于播放动画的更多信息请参阅 :ref:`play<class_AnimationPlayer_method_play>`\ 。

\ **注意：**\ 虽然这个属性会出现在检查器中，但它不是用来编辑的，也不会保存在场景中。该属性主要用于获取当前播放的动画，内部用于动画播放轨道。详情请参阅 :ref:`Animation<class_Animation>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_current_animation_length:

.. rst-class:: classref-property

:ref:`float<class_float>` **current_animation_length**

.. rst-class:: classref-property-setget

- :ref:`float<class_float>` **get_current_animation_length** **(** **)**

当前正在播放的动画的长度（以秒为单位）。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_current_animation_position:

.. rst-class:: classref-property

:ref:`float<class_float>` **current_animation_position**

.. rst-class:: classref-property-setget

- :ref:`float<class_float>` **get_current_animation_position** **(** **)**

当前播放的动画的位置（以秒为单位）。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_method_call_mode:

.. rst-class:: classref-property

:ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>` **method_call_mode** = ``0``

.. rst-class:: classref-property-setget

- void **set_method_call_mode** **(** :ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>` value **)**
- :ref:`AnimationMethodCallMode<enum_AnimationPlayer_AnimationMethodCallMode>` **get_method_call_mode** **(** **)**

方法调用轨道所使用的调用模式。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_movie_quit_on_finish:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **movie_quit_on_finish** = ``false``

.. rst-class:: classref-property-setget

- void **set_movie_quit_on_finish_enabled** **(** :ref:`bool<class_bool>` value **)**
- :ref:`bool<class_bool>` **is_movie_quit_on_finish_enabled** **(** **)**

如果为 ``true``\ ，并且引擎在 Movie Maker 模式下运行（请参阅 :ref:`MovieWriter<class_MovieWriter>`\ ），则在此 **AnimationPlayer** 中播放完动画后，立即使用 :ref:`SceneTree.quit<class_SceneTree_method_quit>` 退出引擎。当引擎因此而退出时，会打印一条消息。

\ **注意：**\ 这与 :ref:`animation_finished<class_AnimationPlayer_signal_animation_finished>` 信号遵循相同的逻辑，因此如果动画被设置为循环，它不会退出引擎。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_playback_active:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **playback_active**

.. rst-class:: classref-property-setget

- void **set_active** **(** :ref:`bool<class_bool>` value **)**
- :ref:`bool<class_bool>` **is_active** **(** **)**

如果为 ``true``\ ，根据流程相关通知更新动画。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_playback_default_blend_time:

.. rst-class:: classref-property

:ref:`float<class_float>` **playback_default_blend_time** = ``0.0``

.. rst-class:: classref-property-setget

- void **set_default_blend_time** **(** :ref:`float<class_float>` value **)**
- :ref:`float<class_float>` **get_default_blend_time** **(** **)**

混合动画的默认时间。范围从 0 到 4096，精度为 0.01。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_playback_process_mode:

.. rst-class:: classref-property

:ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` **playback_process_mode** = ``1``

.. rst-class:: classref-property-setget

- void **set_process_callback** **(** :ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` value **)**
- :ref:`AnimationProcessCallback<enum_AnimationPlayer_AnimationProcessCallback>` **get_process_callback** **(** **)**

更新动画的过程通知。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_reset_on_save:

.. rst-class:: classref-property

:ref:`bool<class_bool>` **reset_on_save** = ``true``

.. rst-class:: classref-property-setget

- void **set_reset_on_save_enabled** **(** :ref:`bool<class_bool>` value **)**
- :ref:`bool<class_bool>` **is_reset_on_save_enabled** **(** **)**

由编辑器使用。如果设置为 ``true``\ ，场景将被保存，并应用重置动画（带有键 ``"RESET"`` 的动画）的效果，就好像它已被定位到时间 0 一样，编辑器保留场景在保存之前的值。

这使得在编辑器中预览和编辑动画更加方便，因为对场景的更改，只要在重置动画中被设置，就不会被保存。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_root_node:

.. rst-class:: classref-property

:ref:`NodePath<class_NodePath>` **root_node** = ``NodePath("..")``

.. rst-class:: classref-property-setget

- void **set_root** **(** :ref:`NodePath<class_NodePath>` value **)**
- :ref:`NodePath<class_NodePath>` **get_root** **(** **)**

节点路径引用将从其运行的节点。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_property_speed_scale:

.. rst-class:: classref-property

:ref:`float<class_float>` **speed_scale** = ``1.0``

.. rst-class:: classref-property-setget

- void **set_speed_scale** **(** :ref:`float<class_float>` value **)**
- :ref:`float<class_float>` **get_speed_scale** **(** **)**

速度缩放比。例如，如果该值为 ``1``\ ，则动画以正常速度播放。如果它是 ``0.5``\ ，那么它会半速播放。如果是 ``2``\ ，则会以双倍速度播放。

如果设置为负值，则动画反向播放。如果设置为\ ``0``\ ，则动画不会前进。

.. rst-class:: classref-section-separator

----

.. rst-class:: classref-descriptions-group

Method Descriptions
-------------------

.. _class_AnimationPlayer_method__post_process_key_value:

.. rst-class:: classref-method

:ref:`Variant<class_Variant>` **_post_process_key_value** **(** :ref:`Animation<class_Animation>` animation, :ref:`int<class_int>` track, :ref:`Variant<class_Variant>` value, :ref:`Object<class_Object>` object, :ref:`int<class_int>` object_idx **)** |virtual| |const|

一个用于播放期间键获取之后的处理的虚函数。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_add_animation_library:

.. rst-class:: classref-method

:ref:`Error<enum_@GlobalScope_Error>` **add_animation_library** **(** :ref:`StringName<class_StringName>` name, :ref:`AnimationLibrary<class_AnimationLibrary>` library **)**

将 ``library`` 添加到该动画播放器的键 ``name`` 下。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_advance:

.. rst-class:: classref-method

void **advance** **(** :ref:`float<class_float>` delta **)**

移动动画时间轴上的位置并立即更新动画。\ ``delta`` 是要移动的时间，单位为秒。会处理位于当前帧和 ``delta`` 之间的事件。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_animation_get_next:

.. rst-class:: classref-method

:ref:`StringName<class_StringName>` **animation_get_next** **(** :ref:`StringName<class_StringName>` anim_from **)** |const|

返回在 ``anim_from`` 动画之后排队播放的动画的键。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_animation_set_next:

.. rst-class:: classref-method

void **animation_set_next** **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to **)**

当 ``anim_from`` 动画完成时，触发 ``anim_to`` 动画。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_clear_caches:

.. rst-class:: classref-method

void **clear_caches** **(** **)**

**AnimationPlayer** 缓存动画节点。如果一个节点消失，它可能不会注意到；\ :ref:`clear_caches<class_AnimationPlayer_method_clear_caches>` 强制它再次更新缓存。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_clear_queue:

.. rst-class:: classref-method

void **clear_queue** **(** **)**

清除所有已排队、未播放的动画。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_find_animation:

.. rst-class:: classref-method

:ref:`StringName<class_StringName>` **find_animation** **(** :ref:`Animation<class_Animation>` animation **)** |const|

返回 ``animation`` 的键；如果未找到，则返回一个空的 :ref:`StringName<class_StringName>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_find_animation_library:

.. rst-class:: classref-method

:ref:`StringName<class_StringName>` **find_animation_library** **(** :ref:`Animation<class_Animation>` animation **)** |const|

返回包含 ``animation`` 的 :ref:`AnimationLibrary<class_AnimationLibrary>` 的键；如果找不到，则返回一个空的 :ref:`StringName<class_StringName>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_animation:

.. rst-class:: classref-method

:ref:`Animation<class_Animation>` **get_animation** **(** :ref:`StringName<class_StringName>` name **)** |const|

返回带有键 ``name`` 的 :ref:`Animation<class_Animation>`\ 。如果动画不存在，则返回 ``null`` 并记录错误。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_animation_library:

.. rst-class:: classref-method

:ref:`AnimationLibrary<class_AnimationLibrary>` **get_animation_library** **(** :ref:`StringName<class_StringName>` name **)** |const|

返回第一个键为 ``name`` 的 :ref:`AnimationLibrary<class_AnimationLibrary>`\ ，如果没有找到则返回 ``null``\ 。

要获得 **AnimationPlayer** 的全局动画库，请使用 ``get_animation_library("")``\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_animation_library_list:

.. rst-class:: classref-method

:ref:`StringName[]<class_StringName>` **get_animation_library_list** **(** **)** |const|

返回存储库的键名列表。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_animation_list:

.. rst-class:: classref-method

:ref:`PackedStringArray<class_PackedStringArray>` **get_animation_list** **(** **)** |const|

返回存储的动画键列表。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_blend_time:

.. rst-class:: classref-method

:ref:`float<class_float>` **get_blend_time** **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to **)** |const|

返回两个动画之间的混合时间（以秒为单位），由它们的键引用。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_playing_speed:

.. rst-class:: classref-method

:ref:`float<class_float>` **get_playing_speed** **(** **)** |const|

返回当前动画的实际播放速度，未播放时则为 ``0``\ 。这个速度是 :ref:`speed_scale<class_AnimationPlayer_property_speed_scale>` 属性乘以调用 :ref:`play<class_AnimationPlayer_method_play>` 时指定的 ``custom_speed`` 参数。

如果当前动画是倒放的，则返回负值。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_get_queue:

.. rst-class:: classref-method

:ref:`PackedStringArray<class_PackedStringArray>` **get_queue** **(** **)**

返回当前排队播放的动画键列表。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_has_animation:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **has_animation** **(** :ref:`StringName<class_StringName>` name **)** |const|

如果该 **AnimationPlayer** 使用键 ``name`` 存储 :ref:`Animation<class_Animation>`\ ，则返回 ``true``\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_has_animation_library:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **has_animation_library** **(** :ref:`StringName<class_StringName>` name **)** |const|

如果该 **AnimationPlayer** 使用键 ``name`` 存储 :ref:`AnimationLibrary<class_AnimationLibrary>`\ ，则返回 ``true``\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_is_playing:

.. rst-class:: classref-method

:ref:`bool<class_bool>` **is_playing** **(** **)** |const|

如果动画目前正在播放，则返回 ``true``\ （即便 :ref:`speed_scale<class_AnimationPlayer_property_speed_scale>` 和/或 ``custom_speed`` 为 ``0``\ ）。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_pause:

.. rst-class:: classref-method

void **pause** **(** **)**

暂停当前播放的动画。\ :ref:`current_animation_position<class_AnimationPlayer_property_current_animation_position>` 将被保留，调用 :ref:`play<class_AnimationPlayer_method_play>` 或 :ref:`play_backwards<class_AnimationPlayer_method_play_backwards>` 时，不带参数或使用与 :ref:`assigned_animation<class_AnimationPlayer_property_assigned_animation>` 相同的动画名称，将恢复动画。

另见 :ref:`stop<class_AnimationPlayer_method_stop>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_play:

.. rst-class:: classref-method

void **play** **(** :ref:`StringName<class_StringName>` name="", :ref:`float<class_float>` custom_blend=-1, :ref:`float<class_float>` custom_speed=1.0, :ref:`bool<class_bool>` from_end=false **)**

播放键名为 ``name`` 的动画。可以设置自定义混合时间和速度。

\ ``from_end`` 选项仅在切换到新的动画轨道，或在相同轨道的开始或结束时生效。它不影响在动画被中途暂停时恢复播放。如果 ``custom_speed`` 为负，且 ``from_end`` 为 ``true``\ ，则动画将向后播放（相当于调用 :ref:`play_backwards<class_AnimationPlayer_method_play_backwards>`\ ）。

\ **AnimationPlayer** 使用 :ref:`assigned_animation<class_AnimationPlayer_property_assigned_animation>` 跟踪其当前或上次播放的动画。如果使用相同的动画 ``name`` 或没有 ``name`` 参数调用此方法，则分配的动画将在暂停时恢复播放。

\ **注意：**\ 动画将在下次处理 **AnimationPlayer** 时更新。如果在调用该方法的同时更新了其他变量，则它们可能更新得太早。要立即执行更新，请调用 ``advance(0)``\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_play_backwards:

.. rst-class:: classref-method

void **play_backwards** **(** :ref:`StringName<class_StringName>` name="", :ref:`float<class_float>` custom_blend=-1 **)**

倒放名称键为 ``name`` 的动画。

这个方法是简写，等价于调用 :ref:`play<class_AnimationPlayer_method_play>` 时使用 ``custom_speed = -1.0`` 和 ``from_end = true``\ ，所以更多信息请参阅其描述。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_queue:

.. rst-class:: classref-method

void **queue** **(** :ref:`StringName<class_StringName>` name **)**

将动画加入队列，在当前动画播放完毕后播放。

\ **注意：**\ 如果当前正在播放循环动画，除非以某种方式停止循环动画，否则排队的动画将永远不会播放。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_remove_animation_library:

.. rst-class:: classref-method

void **remove_animation_library** **(** :ref:`StringName<class_StringName>` name **)**

移除与键 ``name`` 关联的 :ref:`AnimationLibrary<class_AnimationLibrary>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_rename_animation_library:

.. rst-class:: classref-method

void **rename_animation_library** **(** :ref:`StringName<class_StringName>` name, :ref:`StringName<class_StringName>` newname **)**

将与键 ``name`` 关联的 :ref:`AnimationLibrary<class_AnimationLibrary>` 移动到键 ``newname``\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_seek:

.. rst-class:: classref-method

void **seek** **(** :ref:`float<class_float>` seconds, :ref:`bool<class_bool>` update=false **)**

将动画寻道到时间点 ``seconds``\ （单位为秒）。\ ``update`` 为 ``true`` 时会同时更新动画，否则会在处理时更新。当前帧和 ``seconds`` 之间的事件会被跳过。

\ **注意：**\ 寻道至动画的末尾不会触发 :ref:`animation_finished<class_AnimationPlayer_signal_animation_finished>`\ 。如果想要跳过动画并触发该信号，请使用 :ref:`advance<class_AnimationPlayer_method_advance>`\ 。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_set_blend_time:

.. rst-class:: classref-method

void **set_blend_time** **(** :ref:`StringName<class_StringName>` anim_from, :ref:`StringName<class_StringName>` anim_to, :ref:`float<class_float>` sec **)**

指定两个动画（由它们的键所引用）之间的混合时间（以秒为单位）。

.. rst-class:: classref-item-separator

----

.. _class_AnimationPlayer_method_stop:

.. rst-class:: classref-method

void **stop** **(** :ref:`bool<class_bool>` keep_state=false **)**

停止当前播放的动画。动画位置被重置为 ``0``\ ，\ ``custom_speed`` 被重置为 ``1.0``\ 。另见 :ref:`pause<class_AnimationPlayer_method_pause>`\ 。

如果 ``keep_state`` 为 ``true``\ ，则动画状态不会在视觉上更新。

\ **注意：**\ 方法/音频/动画播放轨道不会被该方法处理。

.. |virtual| replace:: :abbr:`virtual (This method should typically be overridden by the user to have any effect.)`
.. |const| replace:: :abbr:`const (This method has no side effects. It doesn't modify any of the instance's member variables.)`
.. |vararg| replace:: :abbr:`vararg (This method accepts any number of arguments after the ones described here.)`
.. |constructor| replace:: :abbr:`constructor (This method is used to construct a type.)`
.. |static| replace:: :abbr:`static (This method doesn't need an instance to be called, so it can be called directly using the class name.)`
.. |operator| replace:: :abbr:`operator (This method describes a valid operator to use with this type as left-hand operand.)`
.. |bitfield| replace:: :abbr:`BitField (This value is an integer composed as a bitmask of the following flags.)`
